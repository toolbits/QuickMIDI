#define					ZeroVariable				(long)0#define					ZeroPointer					(long)0#define					ZeroHandle					(long)0typedef struct AppleEventxManagerStatic{	AEEventHandlerUPP			StartApplicationEventUPP;	AEEventHandlerUPP			OpenAudioFileEventUPP;	AEEventHandlerUPP			StartPrintFileEventUPP;	AEEventHandlerUPP			QuitApplicationEventUPP;} AppleEventxManagerStatic,*AppleEventxManagerStaticPtr,**AppleEventxManagerStaticHandle;//GlobalRoutinesOSErr					SetupAppleEvent				(void);void					ResetAppleEvent				(void);//StaticRoutinesstatic	pascal	OSErr	StartApplicationEvent		(register AppleEvent*,register AppleEvent*,register long);static	pascal	OSErr	OpenAudioFileEvent			(register AppleEvent*,register AppleEvent*,register long);static			OSErr	GotRequiredParams			(register AppleEvent*);static	pascal	OSErr	StartPrintFileEvent			(register AppleEvent*,register AppleEvent*,register long);static	pascal	OSErr	QuitApplicationEvent		(register AppleEvent*,register AppleEvent*,register long);//ExternRoutinesextern	void			SetApplicationQuit			(register Boolean);//StaticMemoriesstatic					AppleEventxManagerStatic	AppleEventxManagerGlobal;	OSErr SetupAppleEvent(void){	OSErr				ResultError;		ResultError = noErr;	AppleEventxManagerGlobal.StartApplicationEventUPP = NewAEEventHandlerProc(StartApplicationEvent);	if((ResultError = AEInstallEventHandler(kCoreEventClass,kAEOpenApplication,AppleEventxManagerGlobal.StartApplicationEventUPP,ZeroVariable,false)) == noErr){		AppleEventxManagerGlobal.OpenAudioFileEventUPP = NewAEEventHandlerProc(OpenAudioFileEvent);		if((ResultError = AEInstallEventHandler(kCoreEventClass,kAEOpenDocuments,AppleEventxManagerGlobal.OpenAudioFileEventUPP,ZeroVariable,false)) == noErr){			AppleEventxManagerGlobal.StartPrintFileEventUPP = NewAEEventHandlerProc(StartPrintFileEvent);			if((ResultError = AEInstallEventHandler(kCoreEventClass,kAEPrintDocuments,AppleEventxManagerGlobal.StartPrintFileEventUPP,ZeroVariable,false)) == noErr){				AppleEventxManagerGlobal.QuitApplicationEventUPP = NewAEEventHandlerProc(QuitApplicationEvent);				if((ResultError = AEInstallEventHandler(kCoreEventClass,kAEQuitApplication,AppleEventxManagerGlobal.QuitApplicationEventUPP,ZeroVariable,false)) != noErr) AERemoveEventHandler(kCoreEventClass,kAEPrintDocuments,AppleEventxManagerGlobal.StartPrintFileEventUPP,false);			}			if(ResultError != noErr) AERemoveEventHandler(kCoreEventClass,kAEOpenDocuments,AppleEventxManagerGlobal.OpenAudioFileEventUPP,false);		}		if(ResultError != noErr) AERemoveEventHandler(kCoreEventClass,kAEOpenApplication,AppleEventxManagerGlobal.StartApplicationEventUPP,false);	}	return(ResultError);}/*SetupAppleEvent*/void ResetAppleEvent(void){	AERemoveEventHandler(kCoreEventClass,kAEOpenApplication,AppleEventxManagerGlobal.StartApplicationEventUPP,false);	AERemoveEventHandler(kCoreEventClass,kAEOpenDocuments,AppleEventxManagerGlobal.OpenAudioFileEventUPP,false);	AERemoveEventHandler(kCoreEventClass,kAEPrintDocuments,AppleEventxManagerGlobal.StartPrintFileEventUPP,false);	AERemoveEventHandler(kCoreEventClass,kAEQuitApplication,AppleEventxManagerGlobal.QuitApplicationEventUPP,false);	return;}/*ResetAppleEvent*/static pascal OSErr StartApplicationEvent(register AppleEvent *EventObject,register AppleEvent *EventReply,register long Reference){	return(noErr);}/*StartApplicationEvent*/static pascal OSErr OpenAudioFileEvent(register AppleEvent *EventObject,register AppleEvent *EventReply,register long Reference){	return(noErr);}/*OpenAudioFileEvent*/static OSErr GotRequiredParams(register AppleEvent *EventObjectPtr){	OSErr				ResultError;		ResultError = noErr;	ResultError = AEGetAttributePtr(EventObjectPtr,keyMissedKeywordAttr,typeWildCard,ZeroPointer,ZeroVariable,ZeroVariable,ZeroPointer);	if(ResultError == errAEDescNotFound) return(noErr);	else if(ResultError == noErr) return(errAEEventNotHandled);	else return(ResultError);}/*GotRequiredParams*/static pascal OSErr StartPrintFileEvent(register AppleEvent *EventObject,register AppleEvent *EventReply,register long Reference){	return(noErr);}/*StartPrintFileEvent*/static pascal OSErr QuitApplicationEvent(register AppleEvent *EventObject,register AppleEvent *EventReply,register long Reference){	SetApplicationQuit(true);	return(noErr);}/*QuitApplicationEvent*/